{% extends "page_base.html" %}

{% block head-title %}{{ victim_names|join:", "|default:event.id }}{% endblock %}

{% block head-scripts %}
        {{ block.super }}
<script type="text/javascript"
        src="http://maps.googleapis.com/maps/api/js?key=AIzaSyD3iM2lzxphBo5JWGKuv4mvLtUUGXnuu7E&sensor=false">
</script>
<script type="text/javascript" src="{{ STATIC_URL }}js/victim_map_display.js"></script>
<script type="text/javascript">
    $(document).ready(function() {
        initializeMap();
        var latLong, markerTitle;
        {% for marker in map_markers %}
            latLong = new google.maps.LatLng({{ marker.lat }}, {{ marker.long }});
            markerTitle = "{{ marker.county }} County";
            addMarker(latLong, markerTitle);
        {% endfor %}
    });
</script>
{% endblock %}

{% block content-title %}
    Lynching{{ victim_names|pluralize }} of {{ victim_names|join:", "}}
    {% if dates %}
        {{ dates.0.year }}
    {% endif %}
{% endblock %}

{% block content-body %}
    <div id="victim_list" class="factlist">
        <h2>Victims</h2>
        {% for victim in event.victims %}
            {% include "events/snippets/victim_summary.html" %}
        {% endfor %}
    </div>
{% endblock %}

{% block aside %}
<aside class="articles">
    <section id="news_articles">
        <header>
            <h3>Primary Sources</h3>
        </header>
        {% for article in articles %}
            {% include "articles/snippets/article_block.html" %}
        {% endfor %}
    </section>
    <section
    <section id="victim_map">
        <header>
            <h3>Count{{ events.victims|pluralize:"y,ies"}} of Lynching{{ event.victims|pluralize }}</h3>
        </header>
        <div id="map_canvas"></div>
    </section>
</aside>
{% endblock %}

{% block endscript %}
{{ block.super }}
<script type="text/javascript" src="{{ STATIC_URL }}js/jquery_plugins/imgpreview.full.jquery.js"></script>
<script type="text/javascript">
    $(document).ready(function(){
        $('.previewImageLink').imgPreview({
            srcAttr: 'data-preview',
            containerID: 'imgPreviewWithStyles',
            distanceFromCursor: {top:10, left:-150},
            // When container is shown:
            onShow: function(link){
                // Animate link:
                $(link).stop().animate({opacity:0.4});
                // Reset image:
                $('img', this).stop().css({opacity:0});
            },
            // When image has loaded:
            onLoad: function(){
                // Animate image
                $(this).animate({opacity:1}, 300);
            },
            // When container hides:
            onHide: function(link){
                // Animate link:
                $(link).stop().animate({opacity:1});
            }
        });
    });
</script>
{% endblock %}
