<?xml version="1.0" encoding="UTF-8"?>
<!-- 
Based very loosely on an example Solr schema from eulfedora indexdata
(adapted from a Solr example schema). For thorough documentation of field
types and options, see:
  http://wiki.apache.org/solr/SchemaXml
  http://svn.apache.org/viewvc/lucene/dev/trunk/solr/example/solr/conf/schema.xml?view=markup
-->
<schema name="galyn" version="1.1">
  <types>
    <fieldType name="string" class="solr.StrField" sortMissingLast="true" omitNorms="true"/>
    <fieldType name="boolean" class="solr.BoolField" sortMissingLast="true" omitNorms="true"/>
    <fieldType name="integer" class="solr.IntField" omitNorms="true"/>
    <fieldType name="long" class="solr.LongField" omitNorms="true"/>
    <fieldType name="float" class="solr.FloatField" omitNorms="true"/>
    <fieldType name="double" class="solr.DoubleField" omitNorms="true"/>
    <fieldType name="sint" class="solr.SortableIntField" sortMissingLast="true" omitNorms="true"/>
    <fieldType name="slong" class="solr.SortableLongField" sortMissingLast="true" omitNorms="true"/>
    <fieldType name="sfloat" class="solr.SortableFloatField" sortMissingLast="true" omitNorms="true"/>
    <fieldType name="sdouble" class="solr.SortableDoubleField" sortMissingLast="true" omitNorms="true"/>
    <fieldType name="date" class="solr.DateField" sortMissingLast="true" omitNorms="true"/>
    <fieldType name="text" class="solr.TextField" positionIncrementGap="100">
      <analyzer type="index">
        <tokenizer class="solr.WhitespaceTokenizerFactory"/>
        <filter class="solr.StopFilterFactory" ignoreCase="true" words="stopwords.txt"/>
        <filter class="solr.WordDelimiterFilterFactory" generateWordParts="1" generateNumberParts="1" catenateWords="1" catenateNumbers="1" catenateAll="0"/>
        <filter class="solr.LowerCaseFilterFactory"/>
        <filter class="solr.EnglishPorterFilterFactory" protected="protwords.txt"/>
        <filter class="solr.RemoveDuplicatesTokenFilterFactory"/>
      </analyzer>
      <analyzer type="query">
        <tokenizer class="solr.WhitespaceTokenizerFactory"/>
        <filter class="solr.SynonymFilterFactory" synonyms="synonyms.txt" ignoreCase="true" expand="true"/>
        <filter class="solr.StopFilterFactory" ignoreCase="true" words="stopwords.txt"/>
        <filter class="solr.WordDelimiterFilterFactory" generateWordParts="1" generateNumberParts="1" catenateWords="0" catenateNumbers="0" catenateAll="0"/>
        <filter class="solr.LowerCaseFilterFactory"/>
        <filter class="solr.EnglishPorterFilterFactory" protected="protwords.txt"/>
        <filter class="solr.RemoveDuplicatesTokenFilterFactory"/>
      </analyzer>
    </fieldType>
  </types>

  <fields>
    <!-- fields on every ComplexObject -->
    <field name="uri" type="string" indexed="true" stored="true" required="true"/>
    <field name="row_id" type="string" indexed="true" stored="true"/>
    <field name="label" type="text" indexed="true" stored="true"/>
    <field name="complex_type" type="string" indexed="true" stored="true"/>

    <!-- fields for MacroEvent -->
    <field name="min_date" type="string" indexed="true" stored="true"/>
    <field name="max_date" type="string" indexed="true" stored="true"/>
    <field name="event_type" type="text" indexed="true" stored="true" multiValued="true"/>
    <field name="outcome" type="text" indexed="true" stored="true" multiValued="true"/>
    <field name="reason" type="text" indexed="true" stored="true" multiValued="true"/>            
    <field name="city" type="text" indexed="true" stored="true" multiValued="true"/>
    <field name="triplet_label" type="text" indexed="true" stored="false" multiValued="true"/>
    <!-- MacroEvent participant data -->
    <field name="participant_uri" type="string" indexed="true" stored="true" multiValued="true"/>
    <field name="participant_last_name" type="text" indexed="true" stored="true" multiValued="true"/>
    <field name="participant_qualitative_age" type="text" indexed="true" stored="true" multiValued="true"/>
    <field name="participant_race" type="text" indexed="true" stored="true" multiValued="true"/>
    <field name="participant_gender" type="text" indexed="true" stored="true" multiValued="true"/>
    <field name="participant_actor_name" type="text" indexed="true" stored="true" multiValued="true"/>
    
    <!-- MacroEvent victims data -->
    <field name="victim_uri" type="string" indexed="true" stored="true" multiValued="true"/>
    <field name="victim_name_brundage" type="text" indexed="true" stored="true" multiValued="true"/>
    <field name="victim_county_brundage" type="text" indexed="true" stored="true" multiValued="true"/>
    <field name="victim_lynchingdate_brundage" type="text" indexed="true" stored="true" multiValued="true"/>
    <field name="victim_race_brundage" type="text" indexed="true" stored="true" multiValued="true"/>
    <field name="victim_allegedcrime_brundage" type="text" indexed="true" stored="true" multiValued="true"/>    

    <!-- everything under a MacroEvent should keep a reference to it for
         navigation and faceting -->
    <field name="macro_event_uri" type="string" indexed="true" stored="true"/>

    <!-- catchall field, containing all other searchable text fields (implemented
        via copyField further on in this schema  -->
    <field name="text" type="text" indexed="true" stored="false" multiValued="true"/>

    <!-- Dynamic field definitions. -->
    <dynamicField name="*_i" type="sint" indexed="true" stored="true"/>
    <dynamicField name="*_s" type="string" indexed="true" stored="true"/>
    <dynamicField name="*_l" type="slong" indexed="true" stored="true"/>
    <dynamicField name="*_t" type="text" indexed="true" stored="true"/>
    <dynamicField name="*_b" type="boolean" indexed="true" stored="true"/>
    <dynamicField name="*_f" type="sfloat" indexed="true" stored="true"/>
    <dynamicField name="*_d" type="sdouble" indexed="true" stored="true"/>
    <dynamicField name="*_dt" type="date" indexed="true" stored="true"/>

    <!-- facet fields populated via copyField -->
    <dynamicField name="*_facet" type="string" indexed="true" stored="true" multiValued="true"/>
  </fields>

  <uniqueKey>uri</uniqueKey>
  <defaultSearchField>text</defaultSearchField>
  <solrQueryParser defaultOperator="OR"/>

  <!-- fields that should be included in the default search -->
  <copyField source="uri" dest="text"/>
  <copyField source="label" dest="text"/>
  <copyField source="event_type" dest="text"/>
  <copyField source="outcome" dest="text"/>
  <copyField source="reason" dest="text"/>      
  <copyField source="city" dest="text"/>
  <copyField source="triplet_label" dest="text"/>
  <copyField source="participant_last_name" dest="text"/>
  <copyField source="participant_qualitative_age" dest="text"/>
  <copyField source="participant_race" dest="text"/>
  <copyField source="participant_gender" dest="text"/>
  <copyField source="participant_actor_name" dest="text"/>
  <copyField source="victim_name_brundage" dest="text"/>
  <copyField source="victim_county_brundage" dest="text"/>
  <copyField source="victim_lynchingdate_brundage" dest="text"/>
  <copyField source="victim_race_brundage" dest="text"/>
  <copyField source="victim_allegedcrime_brundage" dest="text"/>    

  <!-- MacroEvent fields that are probably also interesting as facets -->
  <copyField source="city" dest="city_facet"/>
  <copyField source="participant_last_name" dest="participant_last_name_facet"/>
  <copyField source="participant_qualitative_age" dest="participant_qualitative_age_facet"/>
  <copyField source="participant_race" dest="participant_race_facet"/>
  <copyField source="participant_gender" dest="participant_gender_facet"/>
  <copyField source="participant_actor_name" dest="participant_actor_name_facet"/>
  <copyField source="victim_name_brundage" dest="victim_name_brundage_facet"/>
  <copyField source="victim_county_brundage" dest="victim_county_brundage_facet"/>
  <copyField source="victim_lynchingdate_brundage" dest="victim_lynchingdate_brundage_facet"/>
  <copyField source="victim_race_brundage" dest="victim_race_brundage_facet"/>
  <copyField source="victim_allegedcrime_brundage" dest="victim_allegedcrime_brundage_facet"/>    

</schema>
